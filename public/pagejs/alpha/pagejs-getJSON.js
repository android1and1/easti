// Generated by CoffeeScript 2.3.1
(function() {
  $(function() {
    var get4jsons, getJSON;
    // define a helpful func  - it returns promise.
    get4jsons = function(urls) {
      var promises, thelastone;
      promises = urls.map(function(url) {
        return getJSON(url);
      });
      thelastone = Promise.all(promises);
      return thelastone.then(function(jsons) {
        var dd, dt, err, i, j, json, len, obj, results, v;
        results = [];
        for (j = 0, len = jsons.length; j < len; j++) {
          json = jsons[j];
          try {
            obj = JSON.parse(json);
            results.push((function() {
              var results1;
              results1 = [];
              for (i in obj) {
                v = obj[i];
                dt = $('<dt/>', {
                  text: i
                });
                dd = $('<dd/>', {
                  text: ' ' + v
                });
                $('dl#one').append(dt);
                results1.push($('dl#one').append(dd));
              }
              return results1;
            })());
          } catch (error1) {
            err = error1;
            console.dir(json);
            results.push(console.error(err.msg));
          }
        }
        return results;
      }).catch(function(err) {
        return alert(err);
      });
    };
    getJSON = function(url) {
      var promise;
      promise = new Promise(function(resolve, reject) {
        var xhr;
        xhr = new XMLHttpRequest;
        xhr.responseType = 'json';
        xhr.timeout = 2000; //2s
        xhr.onloadend = function(evt) {
          return resolve(evt.target.response);
        };
        xhr.onerror = function(error) {
          return reject(error);
        };
        xhr.open('POST', url, true);
        return xhr.send(null);
      });
      return promise; //getJSON() define end.
    };
    return $('#ajaxbutton').on('click', function(evt) {
      return get4jsons([
        '/alpha/server-side-data/1',
        '/alpha/server-side-data/2',
        '/alpha/server-side-data/3',
        
        // below is not exists - "da5.json"
        '/alpha/server-side-data/5'
      ]);
    });
  });

}).call(this);
