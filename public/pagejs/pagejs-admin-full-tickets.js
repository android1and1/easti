// Generated by CoffeeScript 2.3.2
(function() {
  $(function() {
    var _display;
    // 2019-09-17 wed
    // filename(pagejs) - public/pagejs-admin-full-tickets.js
    // template - views/admin-full-tickets.pug
    // route - '/admin/admin-full-tickets' 
    $('.cursor').on('click', function(e) {
      var next;
      // offen,treat 'e' as '@',make many mistakes.
      next = $(this).data('next');
      e.preventDefault();
      e.stopPropagation();
      return $.ajax({
        url: '/admin/full-tickets',
        dataType: 'json',
        type: 'POST',
        data: {
          'nextCursor': next
        }
      }).done(function(json) {
        //alert JSON.stringify(json)
        return _display($('#json'), json);
      }).fail(function(one, two, three) {
        return alert(three + ' reason: ' + one.message);
      });
    });
    return _display = function(box, structor) {
      var $ul, d, i, len, next, ref;
      next = structor.next;
      box.append('<hr/>');
      box.append('<h2 class="display-3"> next cursor is:' + next + '</h2>');
      ref = structor.items;
      for (i = 0, len = ref.length; i < len; i++) {
        d = ref[i];
        $ul = $('<ul/>');
        $ul.append('<li>#' + d.ticket_id + '</li>');
        $ul.append('<li>title:<a alt="detail page" href="/admin/get-ticket-by-id/' + d.ticket_id + '">' + d.title + '</a></li>');
        $ul.append('<li>visits:' + d.visits + '</li>');
        box.append($ul);
      }
      if (next !== '0') {
        return box.append('<a role="button" class="cursor btn btn-primary" data-next="' + next + '" > More+ </button>');
      }
    };
  });

}).call(this);
