// Generated by CoffeeScript 2.1.1
(function() {
  // tricks is route for 'saving/updating/deleting/finding' tricks-db (a nohm-like database)
  var Browser, Redis, app, browser, redis, server;

  Redis = require('redis');

  redis = Redis.createClient();

  redis.on('connect', function() {
    // tell how many items about '*:hash:tricks:*'
    return redis.keys('*:hash:tricks:*', function(err, list) {
      var i, item, len, results;
      results = [];
      for (i = 0, len = list.length; i < len; i++) {
        item = list[i];
        results.push(console.log(item));
      }
      return results;
    });
  });

  Browser = require('zombie');

  Browser.localhost('www.fellow5.cn', 4140);

  browser = new Browser;

  browser.waitDuration = '30s';

  app = require('../app.js');

  server = (require('http')).Server(app);

  server.on('error', function(err) {
    console.error('start debug error info::');
    console.error(err);
    return console.error('debug error info end::');
  });

  server.listen(4140);

  describe('it will be successfully while accessing /tricks/add1::', function() {
    before(function(done) {
      return browser.visit('http://www.fellow5.cn/tricks/add1', done);
    });
    after(function() {
      server.close();
      return redis.quit(); // close db connection
    });
    it('it will be success while accessing route - /tricks/add1::', function() {
      browser.assert.success();
      return browser.assert.status(200);
    });
    it('The 3 fields  all have its name attribute::', function() {
      return browser.assert.elements('.form-control[name]', 3);
    });
    it('The form action is same url.href and method is POST::', function() {
      browser.assert.attribute('form', 'action', '');
      return browser.assert.attribute('form', 'method', 'POST');
    });
    return describe('submit form::', function() {
      before(function() {
        browser.fill('textarea', 'there was a game between county a and country b,\nlong long ago..');
        browser.fill('[name=about]', 'aboutone');
        browser.fill('[type=number]', '1111');
        return browser.pressButton('button');
      });
      it('should be redircted to /tricks/successfully page::', function() {
        browser.assert.success();
        return browser.assert.text('title', 'tricks-successfully');
      });
      return it('should add 1 item::', function() {});
    });
  });

}).call(this);
